#!/usr/bin/env bash
set -euo pipefail

dock-dual() {
    xrandr --output DP-1-3 --auto --left-of eDP-1
    xrandr --output DP-1-1 --auto --left-of DP-1-3 --rotate right
    xrandr --output DP-1-3 --pos 1440x600
    xrandr --output eDP-1 --pos 4000x840
    feh --bg-fill ~/wallpaper ~/wallpaper_portrait ~/wallpaper
}

dock-curved() {
    OUTPUT="$1"
    undock
    xrandr --output $OUTPUT --auto --left-of eDP-1
    xrandr --output eDP-1 --pos 3840x400
    xrandr --setmonitor "${OUTPUT}-L" 1280/293x1600/367+0+0 none
    xrandr --setmonitor "${OUTPUT}-R" 2560/587x1600/367+1280+0 $OUTPUT
    feh --bg-fill ~/wallpaper
}

if xrandr | grep "DP-2 connected" &> /dev/null; then
    dock-curved DP-2
else
    dock-dual
fi

v4l2-ctl -d4 --set-ctrl zoom_absolute=150
v4l2-ctl -d4 --set-ctrl backlight_compensation=1
